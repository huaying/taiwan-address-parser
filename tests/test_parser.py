# coding:utf-8
from parser import extract_address
from parser import url_extract_address
from parser import file_extract_address
import os


def test_many_address():
    address_str = u'''
    æ–°ç«¹å¸‚æ­¦é™µè·¯61å··1å¼„28è™Ÿ å°åŒ—å¸‚å—æ¸¯è·¯66è™Ÿ
    æ–°åŒ—å¸‚ä¸‰é‡å€æ­£ç¾©å—è·¯36å··9è™Ÿ
    æ–°åŒ—å¸‚æ°¸å’Œå€æ°¸å¹³è·¯170è™Ÿ
    å°ä¸­å¸‚è¥¿å€ç¾æ‘è·¯ä¸€æ®µ111è™Ÿ å°ä¸­å¸‚è¥¿å€ç¾æ‘è·¯ä¸€æ®µ149å··12è™Ÿ
    å°ä¸­å¸‚è¥¿å€å¿ èª è¡—91è™Ÿ å°ä¸­å¸‚ å°å°ä¸­å¸‚åŒ—å€å¤ªå¹³è·¯63å··1è™Ÿ
    å°ä¸­å¸‚å—å±¯å€æƒ æ–‡è·¯328è™Ÿ
    å°åŒ—å¸‚ä¸­æ­£å€æ±€å·è·¯ä¸‰æ®µ165è™Ÿ å°ä¸­å¸‚çš„æŸæ®µè·¯ä¸Š å°å—å¸‚å®‰å¹³å€å®‰å¹³è·¯418è™Ÿ
    å°ä¸­å¸‚åŒ—å€ä¸‰æ°‘è·¯ä¸‰æ®µ201å··14è™Ÿ
    å°ä¸­å¸‚çƒæ—¥å€å­¸ç”°è·¯8å··68è™Ÿ å°å— å°å—å¸‚ä¸­è¥¿å€æ°‘æ—è·¯äºŒæ®µ160è™Ÿ å°åŒ—å¸‚ä¿¡ç¾©å€æ¾å£½è·¯12è™Ÿ3æ¨“
    å°ä¸­å¸‚å—å±¯å€æ‡·å¾·è¡—59å··6è™Ÿ å°ä¸­å¸‚è¥¿å±¯å€æ–‡è¯è·¯7è™Ÿä¹‹1 è‡ºåŒ—
    å°åŒ—å¸‚æ¾å±±å€å—äº¬æ±è·¯äº”æ®µ291å··29å¼„7è™Ÿ2æ¨“
    '''
    expect = [
        u'æ–°ç«¹å¸‚æ­¦é™µè·¯61å··1å¼„28è™Ÿ',
        u'å°åŒ—å¸‚å—æ¸¯è·¯66è™Ÿ',
        u'æ–°åŒ—å¸‚ä¸‰é‡å€æ­£ç¾©å—è·¯36å··9è™Ÿ',
        u'æ–°åŒ—å¸‚æ°¸å’Œå€æ°¸å¹³è·¯170è™Ÿ',
        u'å°ä¸­å¸‚è¥¿å€ç¾æ‘è·¯ä¸€æ®µ111è™Ÿ',
        u'å°ä¸­å¸‚è¥¿å€ç¾æ‘è·¯ä¸€æ®µ149å··12è™Ÿ',
        u'å°ä¸­å¸‚è¥¿å€å¿ èª è¡—91è™Ÿ',
        u'å°ä¸­å¸‚åŒ—å€å¤ªå¹³è·¯63å··1è™Ÿ',
        u'å°ä¸­å¸‚å—å±¯å€æƒ æ–‡è·¯328è™Ÿ',
        u'å°åŒ—å¸‚ä¸­æ­£å€æ±€å·è·¯ä¸‰æ®µ165è™Ÿ',
        u'å°å—å¸‚å®‰å¹³å€å®‰å¹³è·¯418è™Ÿ',
        u'å°ä¸­å¸‚åŒ—å€ä¸‰æ°‘è·¯ä¸‰æ®µ201å··14è™Ÿ',
        u'å°ä¸­å¸‚çƒæ—¥å€å­¸ç”°è·¯8å··68è™Ÿ',
        u'å°å—å¸‚ä¸­è¥¿å€æ°‘æ—è·¯äºŒæ®µ160è™Ÿ',
        u'å°åŒ—å¸‚ä¿¡ç¾©å€æ¾å£½è·¯12è™Ÿ3æ¨“',
        u'å°ä¸­å¸‚å—å±¯å€æ‡·å¾·è¡—59å··6è™Ÿ',
        u'å°ä¸­å¸‚è¥¿å±¯å€æ–‡è¯è·¯7è™Ÿä¹‹1',
        u'å°åŒ—å¸‚æ¾å±±å€å—äº¬æ±è·¯äº”æ®µ291å··29å¼„7è™Ÿ2æ¨“',
    ]
    res = extract_address(address_str)
    assert len(res) == len(expect)
    assert res == expect


def test_ig_post():
    instagram_post = u'''
    â€”
    ğŸ”ºä¸‰é‡è›‹é¤…ç‹ğŸ”º
    â€”
    âœ”ï¸é›™è›‹è›‹é¤…$40 â€”
    æ²’æœ‰æ˜é¡¯çš„æ‹›ç‰Œä½†ç”Ÿæ„å»éå¸¸çš„å¥½ï¼åº—è£¡æœ‰åˆ†è”¥æ²¹é¤…ã€è›‹é¤…ã€é›™è›‹ï¼Œçš†æ˜¯ä»¥è”¥æ²¹é¤…ç‚ºåŸºåº•ï¼Œæ²’æœ‰è›‹ğŸ¥šã€ä¸€é¡†è›‹ğŸ¥šã€å…©é¡†ğŸ¥šåšç‚ºå€åˆ¥ï¼Œæ­é…ç¨å®¶é†¬æ–™ï½é›–ç„¶ç‚¸éå¯æ˜¯åƒèµ·ä¾†ä¸æ²¹è†©ğŸ˜ğŸ˜é‚„å¸¶é»QQåˆç”œç”œçš„å£æ„Ÿï¼ï¼
    ä¸è™§æ˜¯ç”·ç¥ @raymond.hou èªªçš„ä¸‰é‡è•­è³€ç”²è›‹é¤…ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»
    Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·
    Â·Â·Â·Â·
    ğŸ˜æ–°åŒ—å¸‚ä¸‰é‡å€æ­£ç¾©å—è·¯36å··9è™Ÿ

    ğŸ•°å¹³æ—¥6:00-10:30/é€±æœ«6:00-11:30
    Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·
    ğŸ”´Fbç²‰å°ˆã€ç—å…‹é‚¦ğŸ”è²æ¯”çš„é£Ÿç‰©æ—¥å¸¸
    ğŸ‘‡ğŸ»çœ‹æ›´å¤šå°åŒ—ç¾é£Ÿ
    #è²æ¯”åƒå°åŒ—
    '''
    expect = [u'æ–°åŒ—å¸‚ä¸‰é‡å€æ­£ç¾©å—è·¯36å··9è™Ÿ']
    res = extract_address(instagram_post)
    assert len(res) == len(expect)
    assert res == expect


def test_parse_file():
    curdir = os.path.dirname(os.path.realpath(__file__))
    res = file_extract_address('%s/file.txt' % curdir)
    assert len(res) == 18


def test_parse_url():
    url = 'http://iko40623.pixnet.net/blog/post/434453072'
    res = url_extract_address(url)
    assert res == [u'å°å—å¸‚æ±å€é•·æ¦®è·¯äºŒæ®µ63è™Ÿ']
